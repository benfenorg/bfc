// Copyright (c) Mysten Labs, Inc.
// SPDX-License-Identifier: Apache-2.0

use fastcrypto_zkp::bn254::zk_login::ZkLoginInputs;

// Used in tests or anywhere that fetching up to date JWKs is not possible. This is an example response from https://id.twitch.tv/oauth2/keys
pub const DEFAULT_JWK_BYTES: &[u8] = r#"{"keys":[{"alg":"RS256","e":"AQAB","kid":"1","kty":"RSA","n":"6lq9MQ-q6hcxr7kOUp-tHlHtdcDsVLwVIw13iXUCvuDOeCi0VSuxCCUY6UmMjy53dX00ih2E4Y4UvlrmmurK0eG26b-HMNNAvCGsVXHU3RcRhVoHDaOwHwU72j7bpHn9XbP3Q3jebX6KIfNbei2MiR0Wyb8RZHE-aZhRYO8_-k9G2GycTpvc-2GBsP8VHLUKKfAs2B6sW3q3ymU6M0L-cFXkZ9fHkn9ejs-sqZPhMJxtBPBxoUIUQFTgv4VXTSv914f_YkNw-EjuwbgwXMvpyr06EyfImxHoxsZkFYB-qBYHtaMxTnFsZBr6fn8Ha2JqT1hoP7Z5r5wxDu3GQhKkHw","use":"sig"}]}"#.as_bytes();

/// Returns a valid ZkLoginInputs based on a fixed key, for testing only.
pub fn get_zklogin_inputs() -> ZkLoginInputs {
    thread_local! {
    static ZKLOGIN_INPUTS: ZkLoginInputs = ZkLoginInputs::from_json("{\"proofPoints\":{\"a\":[\"18691400786533836647085774153985023620736138436961835445392801361489115679381\",\"14442956436085427043695358296623192223944010252243768121902312262283110647997\",\"1\"],\"b\":[[\"5285926721022132697494071952821957920019040927245000284377231220186746903407\",\"20961070726923025276757927069226950665294093983765859865674859790704771661775\"],[\"1803949805892317188401249157851399021788942338900833806287013727465352595938\",\"5438476374141959119533094817771785178667623502699752094554719700560591664078\"],[\"1\",\"0\"]],\"c\":[\"21638238177870868370708701777860529204281054042137191909817943405998010601220\",\"16952374762033139324629966729635682770024732117096841604645635302636651181165\",\"1\"]},\"issBase64Details\":{\"value\":\"wiaXNzIjoiaHR0cHM6Ly9pZC50d2l0Y2gudHYvb2F1dGgyIiw\",\"indexMod4\":2},\"headerBase64\":\"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjEifQ\"}", "11123741740672126602579782119889048712914817144266543370111732841664868829558").unwrap(); }
    ZKLOGIN_INPUTS.with(|a| a.clone())
}
