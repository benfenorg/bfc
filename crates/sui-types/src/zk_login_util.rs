// Copyright (c) Mysten Labs, Inc.
// SPDX-License-Identifier: Apache-2.0

use fastcrypto_zkp::bn254::zk_login::ZkLoginInputs;

// Used in tests or anywhere that fetching up to date JWKs is not possible. This is an example response from https://id.twitch.tv/oauth2/keys
pub const DEFAULT_JWK_BYTES: &[u8] = r#"{"keys":[{"alg":"RS256","e":"AQAB","kid":"1","kty":"RSA","n":"6lq9MQ-q6hcxr7kOUp-tHlHtdcDsVLwVIw13iXUCvuDOeCi0VSuxCCUY6UmMjy53dX00ih2E4Y4UvlrmmurK0eG26b-HMNNAvCGsVXHU3RcRhVoHDaOwHwU72j7bpHn9XbP3Q3jebX6KIfNbei2MiR0Wyb8RZHE-aZhRYO8_-k9G2GycTpvc-2GBsP8VHLUKKfAs2B6sW3q3ymU6M0L-cFXkZ9fHkn9ejs-sqZPhMJxtBPBxoUIUQFTgv4VXTSv914f_YkNw-EjuwbgwXMvpyr06EyfImxHoxsZkFYB-qBYHtaMxTnFsZBr6fn8Ha2JqT1hoP7Z5r5wxDu3GQhKkHw","use":"sig"}]}"#.as_bytes();

/// Returns a valid ZkLoginInputs based on a fixed key, for testing only.
pub fn get_zklogin_inputs() -> ZkLoginInputs {
    thread_local! {
    static ZKLOGIN_INPUTS: ZkLoginInputs = ZkLoginInputs::from_json("{\"proofPoints\":{\"a\":[\"2238884949792086380199478914443105608883316920248493687864779557294435015050\",\"20882146810638130322039642717164359579727733664610610773741004157962630990187\",\"1\"],\"b\":[[\"13259841213497455401984177045556325844572081888950064835401195958275852489155\",\"12188107257882710781991418471157907785657417455288644649519753921257601009943\"],[\"11101676239558775391154070942711094088446335809692644102860291157012351589824\",\"8066760152300949776466231712189311058290027087829301278788239211521395343134\"],[\"1\",\"0\"]],\"c\":[\"6256756903021516472515775926084905199979793014541421960212325714359254988545\",\"14443403622290753137492949892525647401245478963101226500387257864370010560476\",\"1\"]},\"issBase64Details\":{\"value\":\"wiaXNzIjoiaHR0cHM6Ly9pZC50d2l0Y2gudHYvb2F1dGgyIiw\",\"indexMod4\":2},\"headerBase64\":\"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjEifQ\"}", "15283092229968459555885154101845715342135998014440759244299983513447538752538").unwrap(); }
    ZKLOGIN_INPUTS.with(|a| a.clone())
}
